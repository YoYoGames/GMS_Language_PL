
  
  xboxlive_stats_get_leaderboard
  Ta funkcja służy do wyświetlania globalnej tabeli rankingowej dla danej statystyki. Podaje się identyfikator użytkownika (zwracany np. przez funkcję xboxlive_get_user()), statystykę string (zdefiniowaną podczas rejestracji jako "Featured Stat"), a następnie określasz szereg szczegółów dotyczących informacji, jakie chcesz uzyskać. Należy pamiętać, że globalną tabelę liderów można wyświetlić tylko dla statystyk int lub real, ale nie dla statystyk string.
  WAŻNE! Statystyki używane w globalnych tabelach liderów muszą być zarejestrowane jako "Featured Stats" w XDP/Windows Dev Center, w przeciwnym razie zostanie zwrócony błąd. Jeśli chcesz korzystać z lokalnych (społecznościowych) rankingów, skorzystaj z funkcji xboxlive_stats_get_social_leaderboard().
  Funkcja wygeneruje wywołanie zwrotne, które spowoduje uruchomienie asynchronicznego zdarzenia społecznościowego. Zdarzenie to będzie miało wbudowaną mapę DS  async_load  która powinna zostać przetworzona pod kątem następujących kluczy:
  
    "id" - będzie utrzymywać stałą achievement_stat_event
    "zdarzenie" - będzie przechowywane na stronie string "GetLeaderboardComplete"
    "userid" - identyfikator użytkownika powiązany z żądaniem
    "error" - 0 w przypadku powodzenia, inna wartość, jeśli wystąpił błąd. Najczęściej zwracane są dwa poniższe błędy:
      
        2145844844: Nie można znaleźć żądanej tabeli liderów (statystyka nie jest zarejestrowana jako wyróżniona statystyka)
        -2145844848: Bad request (stat nie jest prawidłowym typem leaderboarda, np. string)
      
    
    "errormessage" - Adres string z komunikatem o błędzie, jeśli taki jest dostępny.
    "display_name" - Unikalny identyfikator tablicy liderów zdefiniowany na pulpicie nawigacyjnym dostawcy.
    "numentries" - Liczba wejść do tabeli liderów, które otrzymałeś.
  
  Pozostała część mapy DS będzie również zawierać dane tabeli rankingowej w następującym formacie (gdzie "N" to pozycja w tabeli rankingowej, od 0 do "numentries"):
  
    "PlayerN" - Nazwa gracza, gdzie "N" jest liczbą całkowitą odpowiadającą jego pozycji na liście graczy w tabeli rankingowej.
    "PlayeridN" - unikalny identyfikator użytkownika gracza, "N".
    "RankN" -Ranga gracza "N" w tabeli rankingowej.
    "ScoreN" - wynik gracza "N".
  
   
  Składnia:
  xboxlive_stats_get_leaderboard(user_id, stat, num_entries, start_rank, start_at_user, ascending);
  
    
      
        Argument
        Typ
        Opis
      
      
        user_id
        Identyfikator użytkownika konsoli Xbox
        The user ID of the user to get the leaderboard for
      
      
        stat
        String
        The stat (as string) to create the global leaderboard from
      
      
        num_entries
        Real
        The number of entries from the global leaderboard to retrieve
      
      
        start_rank
        Real
        The rank in the leaderboard to start from (use 0 if the "start_at_user" argument is set to true)
      
      
        start_at_user
        Boolean
        Set to true aby zacząć od rangi ID użytkownika, false w przeciwnym razie (ustawione na false, jeśli argument "start_rank" ma wartość inną niż 0)
      
      
        ascending
        Boolean
        Set to true dla porządku rosnącego i false dla porządku malejącego
      
    
  
   
  Zwroty:
  N/A
   
  Przykład rozszerzony:
  Poniżej znajduje się rozszerzony przykład użycia tej funkcji. Na początek należy ją wywołać w jakimś zdarzeniu, takim jak Rozpoczęcie lub Utworzenie pokoju:
  xboxlive_stats_get_leaderboard(user_id, "GlobalTime", 20, 1, false, true);
  Powyższy kod zostanie wywołany w celu uzyskania listy wszystkich pozycji na tablicy liderów społecznościowych w grze i wygeneruje wywołanie zwrotne zdarzenia asynchronicznego społecznościowego, które zostanie obsłużone w następujący sposób:
  if (async_load[? "id"] == achievement_stat_event)
    {
        if (async_load[? "event"] == "GetLeaderboardComplete")
        {
            global.numentries = async_load[? "numentries"];
            for(var i = 0; i < numentries; i++;)
            {
                global.playername[i] = async_load[? "Player" + string(i)];
                global.playerid[i] = async_load[? "Playerid" + string(i)];
                global.playerrank[i] = async_load[? "Rank" + string(i)];
                global.playerscore[i] = async_load[? "Score" + string(i)];
            }
        }
    }
  Powyższy kod sprawdza zwróconą mapę DS w Społecznym zdarzeniu asynchronicznym i jeśli jej "id" pasuje do sprawdzanej stałej, sprawdza, czy zdarzenie zostało wywołane przez zwrócone dane tablicy liderów, a następnie wykonuje pętlę po mapie i zapisuje wszystkie różne wartości w kilku globalnych tablicach.
   
   
   
  
    
      
        Powrót: Statystyki i rankingi
        Następny: xboxlive_stats_get_social_leaderboard
      
    
    © Copyright YoYo Games Ltd. 2022 Wszystkie prawa zastrzeżone.
  
  
  

