
  
  http_get
  Za pomocą tej funkcji użytkownik łączy się z podanym adresem URL w celu pobrania informacji. Ponieważ jest to funkcja asynchroniczna, GameMaker Studio 2 nie zablokuje się w oczekiwaniu na odpowiedź, lecz będzie działać dalej, dopóki nie otrzyma informacji zwrotnej. Informacja ta będzie miała postać string i wywoła zdarzenie Async Event w każdej instancji, która ma je zdefiniowane we właściwościach object. Należy również pamiętać, że parametry żądania HTTP (fragmenty czasami "doklejane" do końca adresu URL, gdy użytkownik przesyła formularz na stronie internetowej) są całkowicie dopuszczalne przy korzystaniu z tej funkcji, na przykład:
  http_get("http://www.YoYoGames.com/logon?username="+name);
  przekaże adres string przechowywany w zmiennej "name" do adresu server oraz pobierze dane z tego adresu URL. Zatem zasadniczo za każdym razem, gdy trzeba przekazać prosty, krótki fragment danych od klienta do server, można użyć tej funkcji.
  UWAGA: Należy pamiętać, że ze względu na ochronę XSS w przeglądarkach, żądania i próby załadowania zasobów z innych domen są blokowane i mogą zwracać puste wyniki. Więcej informacji na ten temat można znaleźć w części poświęconej problemom domen krzyżowych.
  Ta funkcja wygeneruje wiele "wywołań zwrotnych", które zostaną odebrane przez dowolne zdarzenia HTTP. W ten sposób zostanie wygenerowany DS Map (bardziej znany jako "słownik"), który jest wyłączny dla tego zdarzenia i jest przechowywany w specjalnej zmiennej async_load. Ta mapa DS będzie zawierać różne wartości w zależności od tego, czy zwracane są dane, czy nie. Na przykład, jeśli użytkownik zażądał pliku, zdarzenie będzie wyzwalane wielokrotnie po otrzymaniu każdego pakietu danych, dzięki czemu można na przykład wyświetlić pasek postępu. Ogólna struktura mapy DS jest następująca:
  
    id: Identyfikator, który został zwrócony przez polecenie. Jeśli wystrzelisz serię żądań http_, musisz wiedzieć, na które z nich otrzymasz odpowiedź, dlatego użyjesz tej wartości do porównania z wartością zapisaną podczas wysyłania żądania, aby znaleźć właściwe żądanie.
    status: Zwraca wartość mniejszą niż 0 w przypadku błędu, 0 w przypadku zakończenia i 1 w przypadku odebrania pakietów (więcej szczegółów w dalszej części instrukcji).
    wynik: Odebrane dane (tylkostring ).
    url: Pełny adres URL żądany przez użytkownika.
    http_status: Nieprzetworzony kod statusu http (jeśli jest dostępny). Zwraca on standardowy kod statusu dla większości przeglądarek, np.: 304 dla "Not Modified" lub 204 dla "No Content", itd.
  
  Jeśli do gry zwracanych jest wiele pakietów, klawisz wywołania zwrotnego "status" zwróci 1. W takim przypadku mapa DS będzie miała następujące dodatkowe klawisze:
  
    "contentLength": Jest to rozmiar pliku, którego zgodnie z informacją zawartą na stronie server należy się spodziewać (może być -1, jeśli strona server nie zwraca tych danych).
    "sizeDownloaded": Rozmiar danych, które zostały już pobrane.
  
   
  Składnia:
  http_get(url);
  
    
      
        ArgumentTyp
        Opis
     
      
        url
        The web address of the server that you wish to get information from
     
    
  
   
  Zwroty:
  Async Request ID
   
  Przykład rozszerzony:
  Funkcję http_get() można wywołać z dowolnego zdarzenia, a ponieważ jest to funkcja asynchroniczna, wywołanie zwrotne może być niemal natychmiastowe lub może trwać kilka sekund. Wywołanie funkcji jest proste i wygląda mniej więcej tak:
  get = http_get("http://www.MacSweeneyGames.com/logon?username=" + name);
  Powyższy kod przekaże adres string przechowywany w zmiennej "name" do podanego adresu server, a także pobierze dane z tego adresu URL, wywołując zdarzenie Async, które będzie zawierało mapę async_load DS (indeks mapy async_load będzie przechowywany w zmiennej "get", dzięki czemu będzie można sprawdzić, czy wywołanie zwrotne jest prawidłowe). Wywołane zdarzenie Async będzie zdarzeniem podrzędnym HTTP, a w tym zdarzeniu pojawią się następujące elementy:
  if ds_map_find_value(async_load, "id") == get
    {
        if ds_map_find_value(async_load, "status") == 0
        {
            r_str = ds_map_find_value(async_load, "result");
        }
        else
        {
            r_str = "null";
        }
    }
  Powyższy kod najpierw sprawdzi identyfikator utworzonej mapy DS, a następnie sprawdzi "status" wywołania zwrotnego. Jeśli wartość ta jest równa 0 (co oznacza sukces), wynik wywołania zwrotnego zostanie zapisany w zmiennej do wykorzystania w przyszłości, w przeciwnym razie zmienna zostanie ustawiona na wartość domyślną (w tym przypadku "null").
   
   
   
  
    
      
        Powrót: HTTP
        Następny: http_get_file
      
    
    © Copyright YoYo Games Ltd. 2022 Wszystkie prawa zastrzeżone.
  
  
  

