
  
  http_request
  Za pomocą tej funkcji można utworzyć żądanie nagłówka HTTP w celu określenia parametrów operacyjnych transakcji HTTP, które można wykorzystać do wielu rzeczy, takich jak (na przykład) uwierzytelnianie za pomocą nagłówków HTTP w przypadku korzystania z interfejsów API RESTful. Funkcja wymaga podania pełnego adresu IP strony server, z której ma zostać wysłane żądanie, a także typu żądania (jako string, patrz uwaga poniżej): "GET", "HEAD", "POST", "PUT", "DELETE", "TRACE", "OPTIONS" lub "CONNECT". Należy również podać DS map par klucz-wartość (jak strings, gdzie klucz jest polem nagłówka, a wartość wymaganymi danymi nagłówka), a ostatnim argumentem są opcjonalne dane string, które można dodać do żądania, a jeśli nie są potrzebne, to może to być 0 lub pusta string "". Zwróć uwagę, że możesz również wysłać buffer (więcej szczegółów znajdziesz w rozdziale Bufory ), w którym to przypadku ostatnim argumentem będzie indeks wysyłanej strony buffer.
  UWAGA: Nagłówki HTTP zwykle mają format "klucz:wartość", ale ponieważ GameMaker tworzy te pary z mapy ds_map, nie ma potrzeby dodawania dwukropka ":" do klucza lub wartości mapy strings.
  UWAGA: W przypadku użycia adresu buffer jako argumentu body, jeśli pozycja szukania buffer jest na początku (0), to ciało nie jest wysyłane, a adres buffer jest wypełniany odpowiedzią z wywołania http, ale jeśli pozycja szukania buffer jest niezerowa, to zawartość adresu buffer string jest wysyłana jako ciało.
  UWAGA: Należy pamiętać, że ze względu na ochronę XSS w przeglądarkach, żądania i próby załadowania zasobów z innych domen są blokowane i mogą zwracać puste wyniki. Więcej informacji na ten temat można znaleźć w części poświęconej problemom domen krzyżowych.
  Ta funkcja zwraca identyfikator Identyfikator żądania asynchronicznego który może być użyty do identyfikacji jej wywołania zwrotnego, jak opisano poniżej.
  Asynchroniczne wywołanie zwrotne
  To zdarzenie wygeneruje "callback", który zostanie odebrany przez dowolne zdarzenie HTTP Async, w którym to przypadku wygeneruje DS Map, które jest wyłączne dla tego zdarzenia i jest przechowywane w specjalnej zmiennej async_load. Ta mapa DS ma dwa następujące klucze związane z funkcją żądania:
  
    id: ID, które zostało zwrócone przez funkcję. Jeśli wysyłasz serię żądań http_, musisz wiedzieć, na które z nich otrzymasz odpowiedź, dlatego użyjesz tej wartości do porównania z wartością zapisaną podczas wysyłania żądania, aby znaleźć właściwe żądanie.
    response_headers: Jeśli ma wartość większą lub równą 0, przechowuje mapę DS, która zawiera nagłówki HTTP zwrócone wraz z odpowiedzią na żądanie HTTP.
  
   
  Składnia:
  http_request(url, method, header_map, body);
  
    
      
        Argument
        Typ
        Opis
      
      
        url
        String
        The web address of the server that you wish to get information from
      
      
        method
        String
        The request method (normally "POST" lub "GET", ale obsługiwane są wszystkie metody)
      
      
        header_map
        Identyfikator mapy DS
        A ds_map with the required header fields
      
      
        body
        Real, String, , lub ID bufora
        The data to be transmitted following the headers (can be a binary buffer handle)
      
    
  
   
  Zwroty:
  Async Request ID
   
  Przykład:
  var map = ds_map_create();
    ds_map_add(map, "Host", "225.0.0.97:3000");
    ds_map_add(map, "Connection", "keep-alive");
    ds_map_add(map, "Content-Length", "169");
    ds_map_add(map, "Cache-Control", "max-age=0");
    ds_map_add(map, "Authorization", "Basic eW95b19hZG1pbjpjNG5lZmllbGQ=");
    ds_map_add(map, "Accept", "text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8");
    ds_map_add(map, "User-Agent", "Mozilla/5.0 (Windows NT 6.3; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.57 Safari/537.36");
    ds_map_add(map, "Content-Type", "application/x-www-form-urlencoded");
    ds_map_add(map, "Accept-Encoding", "gzip,deflate,sdch");
    ds_map_add(map, "Accept-Language", "en-GB,en-US;q=0.8,en;q=0.6");
    ds_map_add(map, "Cookie", "request_method=GET; _InAppPurchases_session=69bb6ef6eec2b");
    var data="utf8=%E2%9C%93&authenticity_token=kPmS14DcYcuKgMFZUsN3XFfj3mhs%3D&product%5Bname%5D=CatchTheHaggis&product%5Bproduct_id%5D=http_test&commit=Create+Product";
    request = http_request("http:225.0.0.97:3000/products", "POST", map, data);
  Powyższy kod tworzy mapę DS z odpowiednimi nagłówkami HTTP dla funkcji, a następnie tworzy dane string do użycia, ponieważ jest to żądanie typu POST. Na koniec wywoływana jest funkcja, której wartość ID jest przechowywana w zmiennej "request" w celu sprawdzenia jej w zdarzeniu asynchronicznym HTTP.
   
   
   
  
    
      
        Powrót: HTTP
        Następny: http_get
      
    
    © Copyright YoYo Games Ltd. 2022 Wszystkie prawa zastrzeżone.
  
  
  

